<!--pages/trip-create/trip-create.wxml-->
<view class="page-container">
    <!-- 页面标题 -->
    <view class="hero">
        <view class="brand">旅行邀请</view>
        <view class="subtitle">邀请朋友加入，开始记账之旅</view>
    </view>

    <!-- 邀请二维码卡片（始终展示） -->
    <view class="card">
        <view class="card-header">
            <view class="card-title">邀请二维码</view>
            <view class="card-desc">旅行编号：{{tripId}}</view>
        </view>
        <view class="qr-section">
            <image wx:if="{{qrcodeUrl}}" src="{{qrcodeUrl}}" class="qr-image" mode="aspectFit" />
            <view wx:else class="empty-state">
                <view class="empty-icon">🔗</view>
                <view class="empty-text">二维码生成中...</view>
            </view>
            <view class="qr-actions">
                <button class="btn-secondary" bindtap="shareQRCode">分享</button>
            </view>
        </view>
    </view>

    <!-- 成员列表卡片（始终展示） -->
    <view class="card">
        <view class="card-header">
            <view class="card-title">成员列表</view>
            <view class="card-desc">当前 {{memberCount}} 人</view>
            <view style="margin-top: 12rpx;">
                <button class="btn-secondary" bindtap="openAddMemberModal">手动添加成员</button>
            </view>
        </view>
        <view class="members-list">
            <view wx:for="{{members}}" wx:key="id" class="member-item">
                <view class="member-avatar">
                    <image wx:if="{{item.avatarUrl}}" src="{{item.avatarUrl}}" mode="aspectFill" />
                    <view wx:else class="text-avatar">{{item.initials}}</view>
                </view>
                <view class="member-info">
                    <view class="member-name">{{item.displayName || '未设置昵称'}}</view>
                    <view class="member-status">{{item.isCreator ? '创建者' : '成员'}}</view>
                </view>
                <view class="member-actions">
                    <button class="btn-remove" bindtap="removeMember" data-id="{{item.id}}">移除</button>
                </view>
            </view>

            <!-- 空状态 -->
            <view wx:if="{{memberCount <= 1}}" class="empty-state">
                <view class="empty-icon">👥</view>
                <view class="empty-text">还没有成员加入</view>
                <view class="empty-desc">分享二维码邀请朋友吧</view>
            </view>
        </view>
    </view>

    <!-- 账单名称（默认值） -->
    <view class="card">
        <view class="card-header">
            <view class="card-title">账单名称</view>
        </view>
        <view style="margin-top: 30rpx;">
            <input class="text-input" value="{{tripName}}" bindinput="onTripNameInput" placeholder="请输入账单名称" />
        </view>
    </view>

    <!-- 创建按钮（成员数达标即可） -->
    <view class="action-section">
        <button class="btn-primary" bindtap="createTrip" disabled="{{!canCreate}}">
            {{canCreate ? '创建旅行' : '至少需要2名成员'}}
        </button>
    </view>

</view>